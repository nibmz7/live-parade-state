!function(e){function t(t){for(var s,r,n=t[0],a=t[1],o=0,l=[];o<n.length;o++)r=n[o],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&l.push(i[r][0]),i[r]=0;for(s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s]);for(d&&d(t);l.length;)l.shift()()}var s={},i={1:0};function r(t){if(s[t])return s[t].exports;var i=s[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.e=function(e){var t=[],s=i[e];if(0!==s)if(s)t.push(s[2]);else{var n=new Promise((function(t,r){s=i[e]=[t,r]}));t.push(s[2]=n);var a,o=document.createElement("script");o.charset="utf-8",o.timeout=120,r.nc&&o.setAttribute("nonce",r.nc),o.src=function(e){return r.p+""+({0:"admin-screen"}[e]||e)+".js"}(e);var d=new Error;a=function(t){o.onerror=o.onload=null,clearTimeout(l);var s=i[e];if(0!==s){if(s){var r=t&&("load"===t.type?"missing":t.type),n=t&&t.target&&t.target.src;d.message="Loading chunk "+e+" failed.\n("+r+": "+n+")",d.name="ChunkLoadError",d.type=r,d.request=n,s[1](d)}i[e]=void 0}};var l=setTimeout((function(){a({type:"timeout",target:o})}),12e4);o.onerror=o.onload=a,document.head.appendChild(o)}return Promise.all(t)},r.m=e,r.c=s,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(s,i,function(t){return e[t]}.bind(null,i));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r.oe=function(e){throw console.error(e),e};var n=window.webpackJsonp=window.webpackJsonp||[],a=n.push.bind(n);n.push=t,n=n.slice();for(var o=0;o<n.length;o++)t(n[o]);var d=a;r(r.s=14)}([function(e,t,s){"use strict";s.d(t,"b",(function(){return r})),s.d(t,"a",(function(){return n}));const i="PointerEvent"in window;function r(e,...t){let s=null;return{get:()=>{if(!s){let i=[e[0]];t.forEach((t,s)=>{i.push(t,e[s+1])}),s=document.createElement("template"),s.innerHTML=i.join("")}return s}}}class n extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.views={}}render(e,t,s){if(e.appendChild(t.get().content.cloneNode(!0)),s){s.forEach(e=>{this.views[e]=this.shadowRoot.getElementById(e)}),[...this.shadowRoot.querySelectorAll(":not(:defined)")].map(e=>customElements.upgrade(e))}}animate(e,t,s){const i=r=>{e.removeEventListener("animationend",i),s?s():e.classList.remove(t)};e.addEventListener("animationend",i),e.classList.add(t)}onclick(e,t){i?e.onpointerup=t:e.onclick=t}showToast(e){let t=document.createElement("wc-toast");t.textContent=e,document.body.appendChild(t)}}},function(e,t,s){"use strict";s.d(t,"c",(function(){return i})),s.d(t,"e",(function(){return r})),s.d(t,"a",(function(){return n})),s.d(t,"b",(function(){return o})),s.d(t,"d",(function(){return d}));const i="\n    input {\n        --color-primary: #8899a9;\n        --color-primary-dark: #34495e;\n        font: inherit;\n        margin: 15px 0;\n        outline: none;\n        border: 3px solid;\n        border-color: #b9b9b9;\n        border-radius: 3px;\n        padding: 5px;\n        font-size: 1rem;\n        transition: border-color .2s;\n    }\n\n    input:focus {\n        animation: glow 1.5s infinite;\n    }\n        \n    @keyframes glow {\n        0% { border-color: var(--color-primary); }\n        50% { border-color: var(--color-primary-dark); }\n        100% { border-color: var(--color-primary); }\n    }\n",r='\n    <style>\n        #time-selector {\n            display: flex;\n        }\n\n        #time-selector > wc-button {\n            --button-font-size: 1rem;\n            --button-padding: 5px;\n        }\n\n        #time-selector > wc-button:nth-of-type(1) {\n            --button-radius: 35px 0 0 35px;\n        }\n\n        #time-selector > wc-button:nth-of-type(2) {\n            --button-radius: 0 35px 35px 0;\n        }\n    </style>\n\n    <div id="time-selector">\n        <wc-button type="solid">AM</wc-button>\n        <wc-button type="outline">PM</wc-button>\n    </div>\n',n="\n    .card {\n        background: white;\n        box-shadow: 0px 2px 50px 0px rgba(209, 202, 209, 1);\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n    }\n",a=e=>`${(e/1e3).toFixed(1)}s`,o=(e=5e3,t=3e3)=>`\n    .fade-in {\n        animation: fade-in ${a(e)};\n    }\n\n    .fade-out {\n        animation: fade-out ${a(t)};\n    }\n\n    @keyframes fade-in {\n        0% { opacity: 0; }\n        100% { opacity: 1; }\n    }\n\n    @keyframes fade-out {\n        0% { opacity: 1; }\n        100% { opacity: 0; }\n    }\n`,d=(e=10,t=10)=>`\n    @keyframes scale-in {\n        0% { \n            transform: perspective(100px) translateZ(${e}px);\n        }\n        100% { \n            transform: perspective(100px) translateZ(0px);\n        }\n    }\n\n    @keyframes scale-out {\n        0% { \n            transform: perspective(100px) translateZ(0px);\n        }\n        100% { \n            transform: perspective(100px) translateZ(${t}px);\n        }\n    }\n`},function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var i=s(9);class r{constructor(e,t,s,i,r,n){this.branchid=e,this.departmentid=t,this.name=s,this.rank=i,this.status=n,this.email=r}static createStatus(e,t,s){return{code:e,remarks:t,updatedby:s,timestamp:firebase.firestore.FieldValue.serverTimestamp()}}static compare(e,t){let s=i.a.rankToInt(e.rank),r=i.a.rankToInt(t.rank);return s<r?-1:r<s?1:e.name<t.name?-1:t.name<e.name?1:0}static fromDoc(e){let t=e.data().data,s=t.status.am.timestamp,i=t.status.pm.timestamp,r=!1,n=!1;return i&&(i=i.toDate(),t.status.pm.timestamp=i,n=!this.checkSameDay(i)),s&&(s=s.toDate(),t.status.am.timestamp=s,r=!this.checkSameDay(s)),t.status.am.expired=r,t.status.pm.expired=n,{uid:e.id,fullname:t.rank+" "+t.name,...t}}static checkSameDay(e){let t=new Date,s=e.getDate()-t.getDate(),i=0===s&&e.getHours()<17&&t.getHours()<17,r=0===s&&e.getHours()>17&&t.getHours()>17,n=-1===s&&e.getHours()>17&&t.getHours()<17;return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&(i||r||n)}}},function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));class i{static getInstance(){return this.instance||(this.instance=new this),this.instance}}},function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var i=s(1),r=s(0);const n=r.b`<style>#root {position: absolute;top: 0;left: 0;display: flex;justify-items: center;align-items: center;height: 100%;width: 100%;overflow: hidden;z-index: 99;box-sizing: border-box;padding: 0 15px;background: rgba(0,0,0,.2);backdrop-filter: blur(2px);webkit-backdrop-filter: blur(2px);}#dialogue {background: white;border-radius: 5px;box-shadow: 0px 4px 4px rgba(0,0,0,.25);padding: 15px 20px;box-sizing: border-box;width: 100%;transform: perspective(100px) translateZ(0px);}${Object(i.b)()}${Object(i.d)()}div#root.show{animation: fade-in .5s;}div#root.hide  {animation: fade-out .3s forwards;}.show > #dialogue {pointer-events: none;animation: scale-in .5s;}.hide > #dialogue {animation: scale-out .3s forwards;}</style><div id="root"><div id="dialogue"></div></div>`,a=["root","dialogue"];class o extends r.a{constructor(){super(),this.isCancelleable=!0,this.render(this.shadowRoot,n,a);let e=this.views.root,t=this.views.dialogue;this.animate(e,"show",()=>{e.classList.remove("show"),this.onclick(e,e=>{this.isCancelleable&&this.close()}),this.onclick(t,e=>{e.stopPropagation()})})}close(){this.animate(this.views.root,"hide",()=>{this.remove()})}}},function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var i=s(3);class r extends class{constructor(){this._listeners={}}stop(e,t){let s=this._listeners[e].findIndex(e=>e==t);s>=0&&this._listeners[e].splice(s,1)}emit(e,t){this._listeners[e]&&this._listeners[e].forEach(e=>{t?e(t):e()})}on(e,t){this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(t)}empty(){this._listeners={}}}{constructor(){super()}}r.getInstance=i.a.getInstance},function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var i=s(0);const r=i.b`<style>:host {--button-font-size: 1.3rem;--button-padding: 15px 10px;--button-radius: 5px;}:host([type="outline"]), :host([type="solid"]){--button-radius: 2px;}:host([type="solid"]) > button {border: 2px solid var(--color-primary);}:host([type="solid"]) button:active {border-color: var(--color-primary-dark);background: var(--color-primary-dark);}:host([type="outline"]) > button {background: white;color: var(--color-primary);border: 2px solid var(--color-primary);}:host([type="outline"]) button:active {background: rgb(199, 199, 199);}:host([type="plain"]) > button {--button-padding: 10px;--border-radius: 15px;color: var(--color-primary);box-shadow: none;background: transparent;}:host([type="plain"]) > button:active {background: rgba(0,0,0,.1);}button {font: inherit;font-size: var(--button-font-size);padding: var(--button-padding);overflow: hidden;text-overflow: ellipsis;white-space: nowrap;cursor: pointer;outline: none;border-radius: var(--button-radius);color: white;background: var(--color-primary);width: 100%;transition: all .2s;border: none;box-shadow: 0 4px 6px -1px rgba(var(--color-primary-rgb), 0.2), 0 2px 4px -1px rgba(var(--color-primary-rgb), 0.12);}button:active {background: var(--color-primary-dark);}</style><button id="button"><slot></slot></button>`;class n extends i.a{constructor(){super(),this.render(this.shadowRoot,r,["button"]),super.onclick(this.views.button,e=>{this.dispatchEvent(new Event("onclick"))})}set onclick(e){this.addEventListener("onclick",t=>e(t))}}},function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var i=s(1),r=s(0);const n=r.b`<style>#root {height: 100%;width: 100%;}#container {height: 100%;width: 100vw;display: grid;grid-template-columns: 1fr;grid-template-rows: 100%;grid-template-areas: "content";align-items: center;}#container:empty + .loading {display: block;}#container > * {grid-area: content;justify-self: center;}.loading {display: none;position: absolute;width: 40px;height: 40px;top: 50%;left: 50%;margin: -20px 0 0 -20px;background-color: #333;border-radius: 100%;animation: sk-scaleout 1.0s infinite ease-in-out;}@keyframes sk-scaleout {0% {transform: scale(0);}100% {transform: scale(1.0);opacity: 0;}}${Object(i.b)(500,500)}</style><div id="root"><div id="container"></div></div>`,a=["root","container"];class o extends r.a{constructor(){super(),this.render(this.shadowRoot,n,a),this.hasShownFirstScreen=!1}removeView(e){this.animate(e,"fade-out",()=>{e.remove()})}addView(e){if(this.hasShownFirstScreen)this.animate(e,"fade-in"),this.views.container.appendChild(e);else{this.hasShownFirstScreen=!0;let t=document.getElementById("splashscreen");this.animate(t,"fade-out",()=>{t.remove()});let s=document.createElement("div");s.className="loading",this.animate(e,"fade-in",()=>{e.classList.remove("fade-in"),this.views.root.appendChild(s)}),this.views.container.appendChild(e)}}}},function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var i=s(1),r=s(2),n=s(0);const a=n.b`<style>${i.a}#root {padding: 15px 30px;}.card {border-radius: 15px;flex-direction: column-reverse;}#header-holder {display: flex;flex-direction: row;justify-content: space-between;align-items: center;padding: 18px 0;}#header {color: #828282;text-transform: capitalize;font-weight: 500;margin: 0;}#sub-header {border-radius: 15px 15px 0 0;font-weight: 400;}#sub-header:only-child {border-radius: 15px;}.list-item {padding: 10px 15px;transition: .3s background;cursor: pointer;}.list-item:active {background: #F0F0F0;}.list-item:last-child {border-bottom-left-radius: 15px;border-bottom-right-radius: 15px;}.list-item > p {margin: 0;}.list-item #primary-text {text-transform: capitalize;color: #323232;font-weight: 500;}.list-item #primary-text.regular {counter-increment: regular present;color: var(--color-primary);}.list-item #secondary-text {color: #878787;font-size: 0.8rem;font-weight: 400;}.list-item.flash {animation: flash 1s 2 none;}.list-item.shrink {animation: shrink .5s forwards;}.list-item.grow {animation: grow .5s forwards;}@keyframes flash {0% {background-color: white;}50% {background-color: rgba(255, 56, 56, 0.18);}100% {background-color: white;}}@keyframes shrink {0% {max-height: 100px;padding: 10px 15px;opacity: 1;}100% {max-height: 0px;padding: 0 15px;opacity: 0;}}@keyframes grow {0% {max-height: 0px;padding: 0 15px;opacity: 0;}100% {max-height: 100px;padding: 10px 15px;opacity: 1;}}#root.shrink-dep {animation: shrink-dep 1s forwards;}@keyframes shrink-dep {0% {max-height: 1000px;padding: 15px 30px;opacity: 1;}100% {max-height: 0;padding: 0px 30px;opacity: 0;}}</style><div id="root"><div id="header-holder"><h3 id="header"></h3></div><div class="card"><div id="list"></div><div id="sub-header"></div></div></div>`,o=["list","header","sub-header","header-holder","root"],d=n.b`<div class="list-item"><p id="primary-text"></p><p id="secondary-text"></p></div>`;class l extends n.a{constructor(){super(),this.render(this.shadowRoot,a,o),this.uidArray=[],this.items={}}getUser(e){return this.controller.getUser(e)}setController(e){this.controller=e}setDepartment(e){this.id=e.uid,this.departmentName=e.name,this.views.header.textContent=e.name}getUserReferenceNode(e){if(0==this.uidArray.length)return this.uidArray.push(e.uid),null;let t=this.uidArray.length-1,s=null;for(;t>=0;){let i=this.uidArray[t],n=this.getUser(i);if(-1!==r.a.compare(e,n))break;s=this.uidArray[t--]}return this.uidArray.splice(++t,0,e.uid),s?this.items[s].div:null}addUser(e,t=!0){let s=d.get().content.cloneNode(!0),i=s.querySelector(".list-item"),r=s.getElementById("primary-text"),n=s.getElementById("secondary-text");i.id=e.uid,this.items[e.uid]={div:i,primaryText:r,secondaryText:n},this.onclick(i,()=>{this.onUserSelected(e.uid)}),this.setListItemData(this.items[e.uid],e),t&&this.animate(i,"grow",()=>{i.classList.remove("grow")});let a=this.getUserReferenceNode(e);this.views.list.insertBefore(i,a)}setListItemData(e,t){e.primaryText.textContent=this.getItemPrimaryText(t),e.secondaryText.innerHTML=this.getItemSecondaryText(t),t.regular&&e.primaryText.classList.add("regular")}changeUser(e,t=!0){let s=this.getUser(e.uid).rank;s!==e.rank&&(this.removeUser(e,!1),this.addUser(e,!1));let i=this.items[e.uid];s===e.rank&&this.setListItemData(i,e),t&&!i.div.classList.contains("flash")&&this.animate(i.div,"flash",()=>{i.div.classList.remove("flash")})}removeUser(e,t=!0){let s=this.items[e.uid].div;s.id=`${e.uid}-deleted`;var i=this.uidArray.indexOf(e.uid);this.uidArray.splice(i,1),t&&!this.isRemoving?this.animate(s,"shrink",()=>{s.remove()}):s.remove()}shrink(){this.animate(this.views.root,"shrink-dep",()=>{this.remove()})}}},function(e,t,s){"use strict";const i={ranks:{LG:1,MG:2,BG:3,COL:4,SLTC:5,LTC:6,MAJ:7,CPT:8,LTA:9,"2LT":10,CWO:11,SWO:12,MWO:13,"1WO":14,"2WO":15,"3WO":16,DX:36,MSG:37,SSG:38,"1SG":39,"2SG":40,"3SG":41,CFC:42,CPL:43,LCP:44,PTE:45,REC:46},isValid(e){return e in this.ranks||e.toUpperCase().includes("DX")},rankToInt(e){if(e.toUpperCase().includes("DX")){let t=Number(e.substring(2));return this.ranks.DX-t}return this.ranks[e]}};t.a=i},function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var i=s(0);const r=i.b`<style>:host {width: inherit;height: inherit;}#float-button {position: fixed;--button-radius: 50px;--button-font-size: 1.1rem;bottom: 10px;left: 25%;right: 25%;}#root, #content {height: 100%;width: 100%;position: relative;}#list {overflow-x: hidden;overflow-y: scroll;height: 100%;width: 100%;padding-bottom: 70px;padding-top: 10px;box-sizing: border-box;}#list::-webkit-scrollbar {display: none;}#empty {position: absolute;top: 40%;text-align: center;width: 100%;color: #34495e;display: none;}#list:empty + #empty {display: block;}#welcome-text {position: absolute;top: 0;left: 0;right: 0;text-align: center;font-weight: 500;color: var(--color-primary-dark);font-size: 1.1rem;z-index: 95;margin: 0;padding: 10px;cursor: pointer;background: #faf5fab8;box-shadow: none;transition: all .5s;backdrop-filter: blur(2px);}#welcome-text.elevation {box-shadow: 0px 1px 2px 1px #928d8d4f;}</style><div id="root"><div id="content"><div id="list"></div><p id="empty">Loading...</p><wc-button id="float-button"></wc-button><h5 id="welcome-text"></h5></div></div>`,n=["root","list","empty","float-button","welcome-text","content"];class a extends i.a{constructor(){super(),this.render(this.shadowRoot,r,n),this.views.departments={},this.views["float-button"].onclick=this.onFloatButtonClick.bind(this),this.views.list.onscroll=e=>{this.views.list.scrollTop>0?this.views["welcome-text"].classList.add("elevation"):this.views["welcome-text"].classList.remove("elevation")},this.views["welcome-text"].onclick=e=>{let t=document.createElement("sign-out");document.body.appendChild(t)}}setWelcomeText(e){this.views["welcome-text"].textContent=`Hi, ${e}!`}setController(e){this.controller=e}getDepartmentCard(e){return this.views.departments[e]}addDepartment(e){let t=e.uid;if(!this.views.departments[t]){let s=this.createDepartmentCard();this.views.departments[t]=s,s.setDepartment(e),s.setController(this.controller),this.views.list.appendChild(s)}}modifyDepartment(e){this.views.departments[e.uid].setDepartment(e)}removeDepartment(e){this.views.departments[e].shrink(),delete this.views.departments[e]}showEmpty(){this.views.empty.textContent="No departments found"}}},function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var i=s(0);const r=i.b`<style>#root {position: absolute;background: var(--color-primary);z-index: 99;color: white;padding: 10px;display: flex;justify-content: center;text-align: center;bottom: 10px;left: 10px;right: 10px;font-size: 1rem;border-radius: 3px;white-space: pre-line;font-weight: 600;box-shadow: 0 0 4px 1px rgba(60, 58, 60, 0.46);}.slide-up {animation: 5s slide-up forwards;}@keyframes slide-up {0% {transform: translateY(100%) translateY(10px);}10% {transform: translateY(0px);}90% {transform: translateY(0px);}100% {transform: translateY(100%) translateY(10px);}}</style><div id="root"><slot></slot></div>`;class n extends i.a{constructor(){super(),this.render(this.shadowRoot,r,["root"]),this.animate(this.views.root,"slide-up",e=>{this.remove()})}}},function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var i=s(4);const r=s(0).b`<style>h4 {width: 100%;color: #313131;margin-top: 15px;}#confirm{--button-font-size: 1rem;--button-padding: 10px;--button-radius: 3px;}</style><div><h4>Are you sure you want sign out?</h4><wc-button type="solid" id="confirm">Yes. I'm positive.</wc-button></div>`;class n extends i.a{constructor(){super();let e=this.views;this.render(e.dialogue,r,["confirm"]),this.onclick(e.confirm,e=>{ApplicationContext.getAuth().logout(),this.close()})}}},function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var i=s(2),r=s(3);class n extends r.a{constructor(){super(),this.viewSwitcher=document.querySelector("view-switcher"),this.branchRepository=ApplicationContext.getBranchRepository(),this.subscribeUserEvent=this.subscribeUserEvent.bind(this),this.subscribeDepartmentEvent=this.subscribeDepartmentEvent.bind(this),this.users={}}activate(){this.mainView=this.createMainView(),this.mainView.setController(this),this.branchRepository.on("user-event",this.subscribeUserEvent),this.branchRepository.on("department-event",this.subscribeDepartmentEvent)}deactivate(){this.users={},this.viewSwitcher.removeView(this.mainView),this.mainView=null,this.branchRepository.stop("user-event",this.subscribeUserEvent),this.branchRepository.stop("department-event",this.subscribeDepartmentEvent),this.branchRepository.unsubscribe()}getUser(e){return this.users[e]}onViewReady(){this.viewSwitcher.addView(this.mainView)}subscribeUserEvent(e){let t=e.type,s=e.user;if("found"===t){e.users.sort(i.a.compare);for(let t of e.users){let e={type:"added",found:!0,user:t};this.subscribeUserEvent(e)}return void this.onViewReady()}let r=this.mainView.getDepartmentCard(s.departmentid);"added"===t?(r.addUser(s,!e.found),this.users[s.uid]=s):"modified"===t?(r.changeUser(s),this.users[s.uid]=s):"removed"===t&&(r.removeUser(s),delete this.users[s.uid])}subscribeDepartmentEvent(e){let t=e.type,s=e.department;if("found"===t)for(let t of e.departments)this.mainView.addDepartment(t);else"added"===t?this.mainView.addDepartment(s):"modified"===t?this.mainView.modifyDepartment(s):"removed"===t?this.mainView.removeDepartment(s.uid):"empty"===t&&this.mainView.showEmpty()}}},function(e,t,s){"use strict";s.r(t);var i=s(5);const r=(e,t,s,i,r,n)=>({branchid:e,departmentid:t,email:s,name:i,rank:r,regular:n,status:{am:{code:0,remarks:"",timestamp:new Date,updatedby:"Admin"},pm:{code:0,remarks:"",timestamp:new Date,updatedby:"Admin"}}}),n=(e,t)=>({uid:e,name:t});var a={departments:[n(1,"Manpower Branch"),n(2,"Finance Department"),n(3,"Signal Wing"),n(4,"Logistics")],users:[r(1,1,"sean@test.com","Sean","LCP",!1),r(1,1,"john@test.com","John","PTE",!1),r(1,1,"albert@test.com","Albert","MAJ",!1),r(1,1,"lucy@test.com","Lucy","MAJ",!1),r(1,3,"jim@test.com","Jim","LTC",!1),r(1,3,"billy@test.com","Billy","CFC",!1),r(1,3,"paul@test.com","Paul","CPL",!1),r(1,3,"rebecca@test.com","Rebecca","SWO",!1),r(1,4,"bob@test.com","Bob","BG",!1),r(1,4,"mike@test.com","Mike","CPL",!1),r(1,4,"harry@test.com","Harry","REC",!1),r(1,4,"anne@test.com","Anne","CFC",!1)]};class o extends i.a{constructor(){super(),this.isSignedIn=!1}init(){var e=localStorage.getItem("user");e&&(this.isSignedIn=!0),this.isSignedIn?this.emit("signed-in",JSON.parse(e)):this.emit("signed-out")}async getUserToken(){return await firebase.auth().currentUser.getIdTokenResult()}login(e,t){let s,i="admin"===e.split("@")[0];i?s={isAdmin:i,email:"admin@test.com",uid:1}:(s=a.users[5],s.uid="user-5"),localStorage.setItem("user",JSON.stringify(s)),this.isSignedIn||(this.isSignedIn=!0,this.emit("signed-in",s))}logout(){this.isSignedIn=!1,localStorage.clear(),this.emit("signed-out")}}o.instance=null;var d=s(2);class l extends i.a{constructor(){super(),this.uniqueId=0,this.depCount=1,this.users={},this.departments={},a.departments.forEach(e=>{this.depCount++,this.departments[e.uid]=e});let e=a.users;this.changeDate(e[1]),this.changeDate(e[2]),this.changeDate(e[3]),e.forEach(e=>{let t=this.toUser(e);this.users[t.uid]=t})}getUserByEmail(e){for(let t of Object.values(this.users))if(t.email===e)return t;return null}addDepartment(e){this.departments[this.depCount]={uid:this.depCount,name:e},this.emit("department-event",{type:"added",department:this.cloneDepartment(this.departments[this.depCount++])})}updateDepartment(e,t){this.departments[e].name=t,this.emit("department-event",{type:"modified",department:this.cloneDepartment(this.departments[e])})}async deleteDepartment(e){for(let[t,s]of Object.entries(this.users))s.departmentid==e&&(await new Promise(e=>setTimeout(e,500)),this.emit("user-event",{type:"removed",user:s}),delete this.users[t]);this.emit("department-event",{type:"removed",department:{uid:e}}),delete this.departments[e],0===Object.keys(this.departments).length&&this.emit("department-event",{type:"empty"})}async createUser(e){await new Promise(e=>setTimeout(e,1e3));let{emailPrefix:t,name:s,rank:i,departmentid:n,regular:a}=e,o=this.toUser(r(1,n,`${t}@test.com`,s,i,a));this.users[o.uid]=o,this.emit("user-event",{type:"added",user:this.cloneUser(o)})}async updateUser(e){await new Promise(e=>setTimeout(e,1e3));let{uid:t,emailPrefix:s,name:i,rank:r,departmentid:n,regular:a}=e,o=this.users[t];o.email=`${s}@test.com`,o.name=i,o.rank=r,o.departmentid=n,o.regular=a,o.fullname=o.rank+" "+o.name,this.emit("user-event",{type:"modified",user:this.cloneUser(this.users[t])})}async deleteUser(e){await new Promise(e=>setTimeout(e,1e3)),this.emit("user-event",{type:"removed",user:this.users[e]}),delete this.users[e]}async updateUserStatus(e,t,s,i){await new Promise(e=>setTimeout(e,1e3));let r=this.users[s];if(null===e)r.status.am={...t},r.status.am.expired=!1,r.status.pm={...t},r.status.pm.expired=!1;else{let s=e?"am":"pm";r.status[s]={...t},r.status[s].expired=!1}this.emit("user-event",{type:"modified",user:this.cloneUser(r)})}cloneUser(e){let t=JSON.parse(JSON.stringify(e));return t.status.am.timestamp=new Date(t.status.am.timestamp),t.status.pm.timestamp=new Date(t.status.pm.timestamp),t}cloneDepartment(e){return JSON.parse(JSON.stringify(e))}toUser(e){let t=e.status.am.timestamp,s=e.status.pm.timestamp,i=!1,r=!1;return t&&s&&(i=!d.a.checkSameDay(t),r=!d.a.checkSameDay(s)),e.status.am.expired=i,e.status.pm.expired=r,{uid:`user-${this.uniqueId++}`,fullname:e.rank+" "+e.name,...e}}changeDate(e){e.status.am.timestamp=new Date("May 17, 2020 21:15:00"),e.status.pm.timestamp=new Date("May 17, 2020 21:15:00")}async subscribe(e){await new Promise(e=>setTimeout(e,700));let t=Object.values(this.users).map(e=>this.cloneUser(e)),s=Object.values(this.departments).map(e=>this.cloneDepartment(e));this.emit("department-event",{type:"found",departments:s}),this.emit("user-event",{type:"found",users:t})}unsubscribe(){}}l.instance=null;var c=s(6),h=s(7),u=s(1),m=s(0);const p=m.b`<style>:host {width: 70%;}${u.c}${u.a}#email {margin-bottom: 0px;}h3 {margin: 15px 0 10px;}.card {border-radius: 5px;padding: 10px 20px;}#login {--button-font-size: 1rem;--button-padding: 7px;}#error {max-height: 0px;opacity: 0;transition: .5s all;text-overflow: ellipsis;white-space: nowrap;overflow: hidden;font-size: 0.8rem;}#error.show {max-height: 100px;opacity: 1;}</style><div class="card"><h3>Sign in</h3><input id="email" type="email" placeholder="Email" autocomplete="off" required><input id="password" type="password" minlength="8" placeholder="Password" autocomplete="off" required><wc-button id="login">Continue</wc-button><p id="error"></p></div>`,g=["error","email","password","login"];class v extends m.a{constructor(){super(),this.render(this.shadowRoot,p,g),this.views.email.onclick=e=>{this.hideError()},this.views.password.onclick=e=>{this.hideError()}}onSignIn(e){this.views.login.onclick=t=>{let s=!!this.views.email.validity.valid&&this.views.email.value,i=!!this.views.password.validity.valid&&this.views.password.value;if(s)if(i){if(this.isLoading)return;this.isLoading=!1,this.views.login.textContent="Loading...",e(s,i)}else this.showError("Please enter a valid password!");else this.showError("Please enter a valid email!")}}reset(){this.views.login.textContent="Continue",this.views.password.value="",this.isLoading=!1}showError(e){this.views.error.textContent=e,this.views.error.classList.add("show")}hideError(){this.views.error.classList.remove("show")}}var w=s(3);class f extends w.a{constructor(){super(),this.auth=ApplicationContext.getAuth(),this.viewSwitcher=document.querySelector("view-switcher"),this.onError=this.onError.bind(this)}activate(){this.loginView=new v,this.loginView.onSignIn((e,t)=>{this.auth.login(e,t)}),this.auth.on("error",this.onError),this.viewSwitcher.addView(this.loginView)}deactivate(){this.auth.stop("error",this.onError),this.viewSwitcher.removeView(this.loginView),this.loginView=null}onError(e){this.loginView.reset(),this.loginView.showError(e)}}f.instance=null;const y=(e,t)=>{customElements.get(e)||customElements.define(e,t)};var b=()=>{y("wc-button",c.a),y("view-switcher",h.a),y("login-view",v);const e=()=>f.getInstance();return{activate:t=>e().activate(t),deactivate:()=>e().deactivate()}},x=s(10);const k=["NOT SET","PRESENT","RSO/RSI","MC/MA","OIL/LEAVE","AO/OA","OOC/OTHERS"];var S=[{name:"NOT SET",fullName:"NOT SET",category:0},{name:"PRESENT",fullName:"PRESENT",category:1},{name:"RSO",fullName:"RSO",category:2},{name:"RSI",fullName:"RSI",category:2},{name:"MC",fullName:"MC",category:3},{name:"MA",fullName:"MA",category:3},{name:"OIL",fullName:"OFF IN LIEU",category:4},{name:"AL",fullName:"ANNUAL LEAVE",category:4},{name:"UL",fullName:"URGENT LEAVE",category:4},{name:"OL",fullName:"OVERSEAS LEAVE",category:4},{name:"CL",fullName:"COMPASSIONATE LEAVE",category:4},{name:"PL",fullName:"PATERNITY LEAVE",category:4},{name:"PCL",fullName:"PARENT CARE LEAVE",category:4},{name:"CCL",fullName:"CHILD CARE LEAVE",category:4},{name:"AO",fullName:"ATTACHED OUT",category:5},{name:"OA",fullName:"OVERSEAS ATTACHMENT",category:5},{name:"OOC",fullName:"OUT OF CAMP",category:6},{name:"OTHERS",fullName:"OTHERS",category:6}];const C=m.b`<style>#root {max-height: 99.9%;overflow-y: auto;box-sizing: border-box;padding-bottom: 70px;padding-top: 50px;}.category > #header {margin: 50px 0 0 30px;font-weight: 500;}.category:first-child #header {margin-top: 20px;}#strength {position: fixed;width: 100%;top: 0;text-align: center;padding: 10px 0;font-size: 1rem;text-transform: uppercase;font-weight: 700;color: var(--color-primary);background: #faf5fab8;transition: all .5s;backdrop-filter: blur(2px);box-shadow: none;}#strength.elevate {box-shadow: 0px 1px 2px 1px #928d8d4f;}</style><div id="root"><div id="strength"></div><div id="list"></div></div>`,E=m.b`<div class="category"><h2 id="header"></h2><div id="cards"></div></div>`,D=["root","strength","list"];class U extends m.a{constructor(){super(),this.render(this.shadowRoot,C,D),this.timeOfDay=this.id,this.strengthCount={total:0,present:0,current:0},this.views.categories=[],this.views.root.onscroll=e=>{this.views.root.scrollTop>0?this.views.strength.classList.add("elevate"):this.views.strength.classList.remove("elevate")}}setController(e){this.controller=e}createCategory(e){let t=E.get().content.cloneNode(!0),s=t.querySelector(".category"),i=t.getElementById("header"),r=t.getElementById("cards");this.views.categories[e]={div:s,header:i,list:r,count:0,cards:{}},0==e||1==e?this.views.list.prepend(t):this.views.list.appendChild(t)}addUser(e){let t=e.status[this.timeOfDay],s=t.code,i=S[s].category;this.views.categories[i]||this.createCategory(i);let r=this.views.categories[i];if(!r.cards[s]){let e=document.createElement("summary-card");e.setController(this.controller),e.setStatusName(S[s].fullName),e.timeOfDay=this.timeOfDay,r.cards[s]=e,r.list.appendChild(e)}r.cards[s].addUser(e),r.count++,r.header.textContent=`${k[i]} - ${r.count}`,this.strengthCount.total++,1==t.code&&(this.strengthCount.present++,e.regular||0!=t.remarks.length||this.strengthCount.current++),this.updateStrengthCount()}changeUser(e,t){let s=e.status[this.timeOfDay].code,i=S[s].category;this.views.categories[i].cards[s].changeUser(e),e.regular||1!=s||(this.strengthCount.current+=t,this.updateStrengthCount())}removeUser(e){let t=e.status[this.timeOfDay].code,s=S[t].category,i=this.views.categories[s],r=i.cards[t];r.removeUser(e),i.count--,i.header.textContent=`${k[s]} - ${i.count}`,0==r.uidArray.length&&(r.remove(),delete i.cards[t]),0==i.count&&(i.div.remove(),delete this.views.categories[s]),this.strengthCount.total--,1==t&&(this.strengthCount.present--,e.regular||0!=e.status[this.timeOfDay].remarks.length||this.strengthCount.current--),this.updateStrengthCount()}updateStrengthCount(){let e=this.strengthCount,t=`Strength: ${e.total} ~ Present: ${e.present}  Fall-in: ${e.current}`;this.views.strength.textContent=t}}const A=m.b`<style>#root {height: 100%;width: 100%;position: relative;background: #FAF5FA;top: 0;z-index: 97;}#close {position: absolute;bottom: 10px;left: 10px;--button-font-size: 1rem;--button-padding: 7px 15px;--button-radius: 35px;transform: translateY(150%);transition: .3s;}#export {position: absolute;bottom: 10px;--button-font-size: 1rem;left: 45%;transform: translateX(-45%) translateY(150%);--button-padding: 15px;--button-radius: 35px;transition: .3s .1s;}.show > #export {transition: .5s .7s;transform: translateX(-45%) translateY(0px);}.show > #close {transition: .5s .6s;transform: translateY(0px);}</style><div id="root"><summary-view id="am"></summary-view><summary-view id="pm"></summary-view><wc-button id="close">X</wc-button><wc-button id="export">Download file</wc-button></div>`,O=["root","close","export","am","pm"];class T extends m.a{constructor(){super(),this.currentTime="am",this.render(this.shadowRoot,A,O),this.views.export.onclick=()=>{this.prepareDownload()},this.loading=document.createElement("div"),this.loading.id="export-loading",this.loading.innerHTML="Using advanced AI algorithms coupled with state-of-the-art data analytics system assembled by world-renowned programmers, to construct and produce a freshly baked spreadsheet for our unit.",this.setTimeOfDay("am")}show(){this.views.root.classList.add("show")}hide(){this.views.root.classList.remove("show")}setController(e){this.controller=e,this.views.am.setController(e),this.views.pm.setController(e)}setTimeOfDay(e){this.currentTime=e?"am":"pm",this.hiddenTime=e?"pm":"am",this.views[this.currentTime].removeAttribute("hidden"),this.views[this.hiddenTime].setAttribute("hidden","")}addUser(e){this.views.am.addUser(e),this.views.pm.addUser(e)}changeUser(e){const t=t=>{let s=this.controller.getUser(e.uid),i=e.status[t],r=s.status[t];if(r.code!=i.code)this.views[t].removeUser(s),this.views[t].addUser(e);else{let s=r.remarks.length,n=i.remarks.length,a=0;0==s&&n>0&&(a=-1),s>0&&0==n&&(a=1),this.views[t].changeUser(e,a)}};t("am"),t("pm")}removeUser(e){this.views.am.removeUser(e),this.views.pm.removeUser(e)}loadXlsxLibrary(){return new Promise(e=>{if(this.xlsxLibraryLoaded)e();else{this.xlsxLibraryLoaded=!0;let t=document.createElement("script");t.src="https://cdn.jsdelivr.net/npm/xlsx-populate@1.19.1/browser/xlsx-populate.min.js",t.onload=function(){e()},document.head.appendChild(t)}})}prepareDownload(){this.isExporting||(this.isExporting=!0,this.animate(this.loading,"fade-in",async()=>{this.loading.classList.remove("fade-in"),await this.loadXlsxLibrary(),setTimeout(()=>{this.animate(this.loading,"fade-out",()=>{this.loading.remove(),this.loading.classList.remove("fade-out"),this.isExporting=!1})},3e3),this.downloadSpreadsheet()}),document.body.appendChild(this.loading))}async downloadSpreadsheet(){let e=[],t=0,s=0,i=0;const r=e=>this.controller.getUser(e),n=t=>e.push(t);let a=(()=>{let e=new Date,t=e.getMonth()+1;return`${String(e.getDate()).padStart(2,"0")}/${t}/${e.getFullYear()}`})(),o=this.views[this.currentTime].strengthCount;n(["SBW PLC Strength","","",""]),n([]),n(["Date",a]),n(["Total Strength",`${o.present}/${o.total}`]),this.views[this.currentTime].views.categories.forEach((a,o)=>{if(a.count>0)for(let[o,d]of Object.entries(a.cards)){if(d.uidArray.length>0){e.push([]);let a=e.length;for(let e of d.uidArray){let a=r(e),d=a.rank+" "+a.name.toLowerCase().split(" ").map(e=>e.charAt(0).toUpperCase()+e.substring(1)).join(" ");d.length>s&&(s=d.length);let l=["",++t,d];if(17==o||4==o){let e=a.status[this.currentTime].remarks;e.length>i&&(i=e.length),l.push(e.toUpperCase())}n(l)}e[a][0]=`*${S[o].fullName}*`}}});let d=await XlsxPopulate.fromBlankAsync();d.sheet(0).name("Attendance sheet"),d.sheet(0).column("A").style({bold:!0,italic:!0}),d.sheet(0).column("A").width(21),d.sheet(0).column("B").width(10),d.sheet(0).column("C").width(s+5),d.sheet(0).column("D").width(i+5),d.sheet(0).cell("A1").value(e);let l=await d.outputAsync(),c=`SBW PARADE STATE ${a}.xlsx`,h=window.URL.createObjectURL(l),u=document.createElement("a");u.href=h,u.download=c,document.body.appendChild(u),u.click(),u.remove(),await new Promise(e=>setTimeout(e,500)),window.URL.revokeObjectURL(h)}}const L=m.b`<style>#time-selector {position: fixed;z-index: 98;right: 10px;bottom: 10px;}#float-button {left: 15%;right: 35%;}#root {width: 200vw;display: flex;transition: margin-left 800ms cubic-bezier(0.770, 0.000, 0.175, 1.000);margin-left: 0;background: #FAF5FA;}#root.open {margin-left: -100vw;}#content {width: 50%;}#float-button {position: absolute;}summary-screen {width: 50%;}</style>${u.e}`,R=["time-selector"];class P extends x.a{constructor(){super(),this.render(this.views.root,L,R),this.views["float-button"].textContent="View summary",this.views.timeSelectors=this.views["time-selector"].querySelectorAll("wc-button"),this.views.timeSelectors.forEach((e,t)=>e.onclick=e=>this.toggleTime(0==t)),this.isMorning=!0,this.views.summary=new T,this.views.root.appendChild(this.views.summary),this.views.summary.views.close.onclick=this.closeSummaryScreen.bind(this)}connectedCallback(){let e=(new Date).getHours()<12;this.toggleTime(e)}setController(e){super.setController(e),this.views.summary.setController(e)}toggleTime(e){if(this.isMorning===e)return;this.isMorning=e,this.views.summary.setTimeOfDay(e);let t=e?"solid":"outline",s=e?"outline":"solid";this.views.timeSelectors[0].setAttribute("type",t),this.views.timeSelectors[1].setAttribute("type",s);for(let t of Object.values(this.views.departments))t.setTimeOfDay(e)}createDepartmentCard(){return document.createElement("user-department-card")}onFloatButtonClick(){this.views.root.classList.add("open"),this.views.summary.show()}closeSummaryScreen(){this.views.summary.hide(),this.views.root.classList.remove("open")}}var I=s(8);const N=m.b`<style>#sub-header {padding: 10px;text-align: center;font-weight: 300;background: #33475a;font-size: 0.9rem;color: white;}#secondary-text {white-space: pre-line;font-size: 0.7rem;margin-top: 3px;letter-spacing: 0.1em;text-transform: uppercase;}#secondary-text > span {color: var(--color-primary);font-weight: 500;text-transform: capitalize;}.card {counter-reset: am-total am-reg am-nsf pm-total pm-reg pm-nsf;}.am > #sub-header::before {content: counter(am-total) " Total ~ " counter(am-reg) " Regular + " counter(am-nsf) " Nsf";}.pm > #sub-header::before {content: counter(pm-total) " Total ~ " counter(pm-reg) " Regular + " counter(pm-nsf) " Nsf";}.am > #list > .list-item[am-reg] {counter-increment: am-total am-reg;}.am > #list > .list-item[am-nsf] {counter-increment: am-total am-nsf;}.pm > #list > .list-item[pm-reg] {counter-increment: pm-total pm-reg;}.pm > #list > .list-item[pm-nsf] {counter-increment: pm-total pm-nsf;}</style>`;class V extends I.a{constructor(){super(),this.render(this.shadowRoot,N),this.isEditable=!1,this.dialogue={isopen:!1,uid:null,view:null},this.timeOfDay="am",this.views.card=this.shadowRoot.querySelector(".card"),this.views.card.classList.add("am")}getItemPrimaryText(e){return e.fullname}getItemSecondaryText(e){let t=e.status,s=this.getStatus(t.am,"AM"),i=this.getStatus(t.pm,"PM");return t.am.expired&&(s+=" <span>-- Expired</span>"),t.pm.expired&&(i+=" <span>-- Expired</span>"),s+"\n"+i}getStatus(e,t){let s=e.remarks.length>0,i=`${t}: ${S[e.code].name}`;return s?`${i} (${e.remarks})`:i}updateDialogue(e){let t=this.getUser(e.status.am.updatedby),s=this.getUser(e.status.pm.updatedby),i=t?t.fullname:"admin",r=s?s.fullname:"admin";this.dialogue.view.setUser(e,i,r)}onUserSelected(e){let t,s=this.getUser(e);this.isEditable?(t=document.createElement("edit-status"),t.timeOfDay=this.timeOfDay,t.setController(this.controller)):t=document.createElement("status-details"),t.ondismiss=()=>{this.dialogue.isopen=!1,this.dialogue.uid=null,this.dialogue.view=null},this.dialogue.isopen=!0,this.dialogue.uid=e,this.dialogue.view=t,this.updateDialogue(s),document.body.appendChild(t)}setTimeOfDay(e){let t=e?"am":"pm";this.views.card.classList.replace(this.timeOfDay,t),this.timeOfDay=t}setListItemData(e,t){super.setListItemData(e,t);const s=(s,i)=>{let r=t.regular?`${s}-reg`:`${s}-nsf`;1===i?e.div.setAttribute(r,""):e.div.removeAttribute(r)};s("am",t.status.am.code),s("pm",t.status.pm.code)}changeUser(e,t=!0){super.changeUser(e,t),this.dialogue.isopen&&this.dialogue.uid==e.uid&&e.status.am.timestamp&&e.status.pm.timestamp&&this.updateDialogue(e)}}var $=s(4);const M=m.b`<style>.container {position: relative;}#status-chooser {display: flex;flex-wrap: wrap;width: 100%;}#status-chooser > wc-button {margin-right: 10px;margin-bottom: 10px;--button-font-size: 0.9rem;--button-padding: 7px;--button-radius: 5px;}.remarks {margin-bottom: 25px;}.remarks > p {margin: 5px 0;}input {padding: 5px;border: 1px solid grey;transition: all .3s .3s;outline:none;font: inherit;text-transform: uppercase;}input:focus {outline: none;border: 1px solid #FF3838;}.header {display: flex;align-items: center;}.header > h4 {flex-grow: 1;}#comment {margin-top: 10px;font-size: 0.6rem;white-space: pre-line;text-align: center;}.expired {text-align: center;font-weight: 900;color: var(--color-primary);max-height: 0;opacity: 0;transition: .5s all;}:host([expired="true"]) .expired {max-height: 100px;opacity: 1;}.verify-buttons {display: flex;position: relative;}.verify-buttons > wc-button {--button-font-size: 1rem;--button-padding: 15px;}#save-all {flex-grow: 1;margin-right: 10px;}#processing {position: absolute;top: 0;left: 0;height: 100%;width: 100%;display: flex;justify-content: center;align-items: center;background: var(--color-primary);color: white;border-radius: 5px;pointer-events: none;opacity: 0;transition: .3s all;}#processing.show {pointer-events: inherit;opacity: 1;}</style><div class="container"><div class="expired">[Expired] - Please verify again</div><div class="header"><h4 id="name"></h4>${u.e}</div><div id="status-chooser"></div><div class="remarks"><p>Remarks</p><input id="remarks-input" maxlength="20" type="text" placeholder="${"Event, work, pooping etc."}"></div><div class="verify-buttons"><wc-button id="save-all">Verify</wc-button><wc-button id="save-only">AM only</wc-button><div id="processing">Processing...</div></div><div id="comment"></div></div>`,z=["remarks-input","status-chooser","comment","name","save-all","save-only","time-selector","processing"];class j extends $.a{constructor(){super(),this.timeOfDay="am",this.status={am:{},pm:{}},this.views.statusChooser=[],this.isProcessing=!1,this.render(this.views.dialogue,M,z),this.views["save-all"].onclick=this.verifyAll.bind(this),this.views["save-only"].onclick=this.verifyOnly.bind(this),this.views["remarks-input"].onblur=e=>{this.saveRemarks()},this.views.timeSelectors=this.views["time-selector"].querySelectorAll("wc-button"),this.views.timeSelectors.forEach((e,t)=>e.onclick=e=>this.toggleTime(0==t)),this.populateStatusChooser()}close(){this.ondismiss(),super.close()}setController(e){this.controller=e}toggleTime(e){this.saveRemarks(),this.timeOfDay=e?"am":"pm";let t=e?"solid":"outline",s=e?"outline":"solid",{code:i,remarks:r,updater:n,date:a,expired:o}=this.status[this.timeOfDay];this.views["remarks-input"].value=r,this.views.comment.textContent=`Last verified by ${n}\non ${a}`,this.views.timeSelectors[0].setAttribute("type",t),this.views.timeSelectors[1].setAttribute("type",s),this.views["save-only"].textContent=`${this.timeOfDay.toUpperCase()} only`,this.setStatus(i),this.setAttribute("expired",o)}saveRemarks(){this.status[this.timeOfDay].remarks=this.views["remarks-input"].value}sendUserUpdates(e){let t=this.status[this.timeOfDay].code,s=this.views["remarks-input"].value.trim();this.controller.updateUserStatus(e,t,s,this.user.uid)}verifyOnly(e){this.isProcessing||(this.isProcessing=!0,this.views.processing.classList.add("show"),this.sendUserUpdates("am"===this.timeOfDay))}verifyAll(e){if(this.isProcessing)return;this.isProcessing=!0;let t="am"===this.timeOfDay?"pm":"am";this.status[t].code=this.status[this.timeOfDay].code,this.views.processing.classList.add("show"),this.sendUserUpdates(null)}setStatus(e){this.views.prevButton&&this.views.prevButton.setAttribute("type","outline"),this.views.statusChooser[e].setAttribute("type","solid"),this.views.prevButton=this.views.statusChooser[e],this.status[this.timeOfDay].code=e}populateStatusChooser(){S.forEach((e,t)=>{let s=document.createElement("wc-button");s.setAttribute("type","outline"),s.textContent=e.name,s.onclick=e=>{this.status[this.timeOfDay].code!==t&&(this.setStatus(t),this.views["remarks-input"].value="")},this.views["status-chooser"].appendChild(s),this.views.statusChooser.push(s)})}setUser(e,t,s){this.isProcessing=!0,this.user=e,this.compareStatusDate("am",t),this.compareStatusDate("pm",s),this.toggleTime("am"==this.timeOfDay),this.views.name.textContent=e.fullname,this.views.processing.classList.remove("show"),this.isProcessing=!1}compareStatusDate(e,t){let s=this.user.status[e],i=s.timestamp,r=this.status[e].date;if(!r||r.getTime()!=i.getTime()){let r={code:Number(s.code),remarks:s.remarks,expired:s.expired,date:i,updater:t};this.status[e]=r,this.timeOfDay==e&&(this.views["remarks-input"].value=this.status[e].remarks)}}updateAfternoonStatus(){this.pmStatus=this.user.status.pm.code,this.pmRemarks=this.user.status.pm.remarks,this.pmDate=this.user.status.pm.timestamp}}const B=m.b`<style>.container {}.name {text-align: center;font-size: 1.2rem;font-weight: 700;text-transform: capitalize;color: #2b2929;margin-bottom: 10px;}.status {text-align: center;margin-bottom: 10px;white-space: pre-line;letter-spacing: 0.1em;text-transform: uppercase;color: #823333;font-weight: 900;}.updatedby {text-align: center;font-size: .6rem;white-space: pre-line;}.remarks {text-align: center;margin-bottom: 10px;text-transform: uppercase;font-weight: 700;color: #9C27B0;font-size: 0.9rem;}.status > span {color: var(--color-primary);text-transform: capitalize;}.seperator {margin: 20px;height: 1px;border-bottom: 3px dashed var(--color-primary);}</style><div class="container"><div class="name"></div><div class="status"></div><div class="remarks"></div><div class="updatedby"></div><div class="seperator"></div><div class="status"></div><div class="remarks"></div><div class="updatedby"></div></div>`;class F extends $.a{constructor(){super();let e=this.views;this.render(e.dialogue,B),this.name=this.shadowRoot.querySelector(".name"),this.status=this.shadowRoot.querySelectorAll(".status"),this.updatedby=this.shadowRoot.querySelectorAll(".updatedby"),this.remarks=this.shadowRoot.querySelectorAll(".remarks")}setUser(e,t,s){this.name.textContent=e.fullname+" Status",this.setInfo(e.status.am,0,"am",t),this.setInfo(e.status.pm,1,"pm",s)}setInfo(e,t,s,i){let r=e.timestamp,n=e.remarks.length>0,a=`${s}: ${S[e.code].fullName}`;e.expired&&(a=" <span>[Expired]</span>\n"+a),this.status[t].innerHTML=a,this.remarks[t].textContent=n?"Remarks: "+e.remarks:"",this.updatedby[t].textContent=`Last verified by ${i}\non ${r}`}}const H=m.b`<style>#sub-header {padding: 10px;text-align: center;background: #33475a;font-size: 0.9rem;color: white;}#secondary-text {text-transform: lowercase;}#secondary-text > .remarks {text-transform: uppercase;}#secondary-text > .expired {color: var(--color-primary);font-weight: 700;text-transform: capitalize;}.card {counter-reset: total reg nsf;}#sub-header::before {content: counter(total) " Total ~ " counter(reg) " Regular + " counter(nsf) " Nsf";}#list > .list-item[reg] {counter-increment: total reg;}#list > .list-item[nsf] {counter-increment: total nsf;}</style>`;class q extends I.a{constructor(){super(),this.render(this.shadowRoot,H),this.timeOfDay="am"}setStatusName(e){this.views.header.textContent=e}getItemPrimaryText(e){return e.fullname}getItemSecondaryText(e){let t=e.status[this.timeOfDay].remarks,s=e.status[this.timeOfDay].expired?'<span class="expired"> -- Expired</span>':"";return(t.length>0?`Remarks: <span class="remarks">${t}</span>`:"")+s}setListItemData(e,t){super.setListItemData(e,t);let s=t.regular?"reg":"nsf",i=t.regular?"nsf":"reg";e.div.setAttribute(s,""),e.div.removeAttribute(i)}addUser(e){super.addUser(e,!1)}removeUser(e){super.removeUser(e,!1)}changeUser(e){super.changeUser(e,!1)}onUserSelected(e){}}var Y=s(11),_=s(12),J=s(13);class W extends J.a{constructor(){super(),this.viewName="user"}createMainView(){return document.createElement("user-view")}updateUserStatus(e,t,s,i){let r=d.a.createStatus(t,s,this.userid);this.branchRepository.updateUserStatus(e,r,i,this.branchid)}activate(e){super.activate(),this.users={},this.userid=e.uid,this.branchid=e.branchid,this.departmentid=e.departmentid,this.branchRepository.subscribe(e.branchid)}onViewReady(){let e=this.users[this.userid];if(this.mainView.setWelcomeText(e.fullname),e.regular)for(const e in this.mainView.views.departments)this.mainView.views.departments[e].isEditable=!0;super.onViewReady()}subscribeUserEvent(e){let t=e.type,s=e.user;"added"===t?this.mainView.views.summary.addUser(s):"modified"===t?this.mainView.views.summary.changeUser(s):"removed"===t&&this.mainView.views.summary.removeUser(s),super.subscribeUserEvent(e)}subscribeDepartmentEvent(e){if("found"===e.type){let t,s=e.departments.filter(e=>{let s=e.uid===this.departmentid;return s&&(t=e),!s});s.unshift(t);for(let e of s)this.mainView.addDepartment(e);this.mainView.views.departments[this.departmentid].isEditable=!0}else super.subscribeDepartmentEvent(e)}}W.instance=null;const G=(e,t)=>{customElements.get(e)||customElements.define(e,t)};var X=()=>{G("view-switcher",h.a),G("wc-button",c.a),G("wc-toast",Y.a),G("sign-out",_.a),G("edit-status",j),G("status-details",F),G("user-department-card",V),G("summary-card",q),G("summary-view",U),G("summary-screen",T),G("user-view",P);const e=()=>W.getInstance();return{activate:t=>e().activate(t),deactivate:()=>e().deactivate()}};var Z=class{constructor(){this.auth=this.getAuth(),this.auth.on("signed-out",this.onSignedOut.bind(this)),this.auth.on("signed-in",this.onSignedIn.bind(this))}init(){this.auth.init()}onSignedOut(){this.hideCurrentScreen(),this.showLogicScreen()}onSignedIn(e){this.hideCurrentScreen(),e.isAdmin?this.showAdminScreen(e):this.showUserScreen(e)}hideCurrentScreen(){this.currentScreen&&this.currentScreen.deactivate()}showLogicScreen(){this.loginScreen||(this.loginScreen=b()),this.currentScreen=this.loginScreen,this.loginScreen.activate()}async showAdminScreen(e){if(!this.adminScreen){let{default:e}=await s.e(0).then(s.bind(null,15));this.adminScreen=e()}this.currentScreen=this.adminScreen,this.adminScreen.activate(e)}showUserScreen(e){this.userScreen||(this.userScreen=X()),this.currentScreen=this.userScreen,this.userScreen.activate(e)}getAuth(){}getBranchRepository(){}getAdminManager(){}};class K extends w.a{constructor(){super()}async init(e,t){this.branchRepository=ApplicationContext.getBranchRepository(),this.adminid=e,this.email=t,this.domain=t.split("@")[1]}changeBranchName(e){}changeDepartmentName(e,t){this.branchRepository.updateDepartment(e,t)}createDepartment(e){this.branchRepository.addDepartment(e)}async deleteDepartment(e){await new Promise(e=>setTimeout(e,2e3)),await this.branchRepository.deleteDepartment(e)}async createUser(e){await new Promise(e=>setTimeout(e,1e3));let t=`${e.emailPrefix}@${this.domain}`;if(this.branchRepository.getUserByEmail(t))throw Error();this.branchRepository.createUser(e)}async updateUser(e){await new Promise(e=>setTimeout(e,1e3));let t=`${e.emailPrefix}@${this.domain}`,s=this.branchRepository.getUserByEmail(t);if(s&&(!s||s.uid!==e.uid))throw Error();this.branchRepository.updateUser(e)}updatePassword(e,t){}deleteUser(e,t){this.branchRepository.deleteUser(t)}}K.instance=null,window.firebase={firestore:{FieldValue:{serverTimestamp:function(){return new Date}}}};window.ApplicationContext=new class extends Z{constructor(){super()}async showUserScreen(e){this.currentScreen&&await new Promise(e=>setTimeout(e,700)),super.showUserScreen(e)}getAuth(){return o.getInstance()}getBranchRepository(){return l.getInstance()}getAdminManager(){return K.getInstance()}},ApplicationContext.init()}]);